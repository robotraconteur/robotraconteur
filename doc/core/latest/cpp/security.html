<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Robot Raconteur Core C++ Library: Security</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-icon.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Robot Raconteur Core C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Security </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_C__Users_wasonj_Documents_RobotRaconteur2_robotraconteur_docs_framework_security"></a> Robot Raconteur provides security using security policies, client authentication, and TLS encrypted transports.</p>
<h1><a class="anchor" id="security_policy"></a>
Security Policy</h1>
<p>Services can optionally have a "security policy". This security policy includes an authentication mechanism and the privileges for anonymous and authenticated users. Typically the authentication is password based, using username/password pairs. Authentication may also use TLS certificates for public-key authentication. Privileges specify if authentication is required and fine-grained privileges for each user.</p>
<h1><a class="anchor" id="tls_certificates"></a>
TLS Certificates</h1>
<p>Robot Raconteur provides security through a combination of Transport Layer Security (TLS) and X.509 certificates issued by Wason Technology, LLC in partnership with Digicert. TLS provides strong security using RSA encryption combined with a symmetric encryption algorithm, most commonly AES. AES provides military grade encryption, and because most modern processors contain hardware acceleration, performance is very high. Certificates are used to validate the identity of nodes communicating using 4096-bit RSA keys. The use of TLS over the Robot Raconteur TCP Transport is transparent to the user requiring only a change in the URL. Using TLS requires installation of an identity X.509 certificate on the service node and optionally the client node if certificates are used for authentication. TLS 1.2 is defined in <a href="https://tools.ietf.org/html/rfc5246">IETF RFC 5246</a>. X.509 v3 certificates are defined in <a href="https://tools.ietf.org/html/rfc5280">IETF RFC 5280</a>.</p>
<h2>Node Identity Certificates</h2>
<p>Identity certificates are an important part of TLS and provide a way to guarantee that the connected peer is not an imposter. Certificates use what is called "Asymmetric Encryption". "Asymmetric Encryption" keys have two parts: a public key that is globally available, and a private key that is kept secret and known only to the assigned node. The public key is encased in a "Certificate" that is "signed" by an "authority" that guarantees the identity of the certificate. The private key is installed on the server/device that corresponds to the identity. When a client connects to the server/device, it compares the certificate of the server/device to the "root certificate" distributed by the authority. This root certificate is published and is known by all devices that need to authenticate certificates. The root is automatically included in all versions of Robot Raconteur.</p>
<p>Certificates are issued by Wason Technology, LLC to guarantee the Node Id identity of the assigned node. A NodeID is a 128 bit UUID that can be represented as a string of hexadecimal numbers. An example UUID is: </p><pre class="fragment">{8afda3b2-f70b-4b41-8086-71b0b3415e86}
</pre><p>The assigned certificate guarantees that the Node ID is unique and that only one device will have a certificate assigned to this NodeID. The common name has the form "Robot Raconteur Node {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}", where the "x" are replaced with the NodeID in hex form. For example, </p><pre class="fragment">Robot Raconteur Node {8afda3b2-f70b-4b41-8086-71b0b3415e86}
</pre><h2>Certificate Extensions</h2>
<p>Robot Raconteur certificates contain custom X.501 v3 extensions marked "critical". See <a href="https://tools.ietf.org/html/rfc5280">IETF RFC 5280</a> for more information about certificates and extensions. Extensions that are marked critical require that the client reject the certificate if it doesn't understand the extension. Extensions not marked critical may be ignored if not understood. Because the certificates used by Robot Raconteur include these custom extensions, they cannot be used for standand DNS HTTP certificates, and standard DNS HTTP certificates cannot be used for Robot Raconteur.</p>
<p>See the <a href="https://github.com/johnwason/robotraconteur_standards/blob/master/draft/tls_certificates.md">Robot Raconteur Public Key Certificates</a> standards document for more information.</p>
<h2>Certificate Distribution</h2>
<p>Certificates for Robot Raconteur nodes are sold by Wason Technology, LLC. Please visit <a href="http://robotraconteur.com">http://robotraconteur.com</a> for more information on how to acquire certificates.</p>
<h2>Certificate Installation Locations</h2>
<p>Certificates are loaded by Robot Raconteur from the user certificate store (Windows), or from the user's home directory (Linux, Mac OSX). The location searched for certificates are in the following table:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">OS  </th><th class="markdownTableHeadNone">Location   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Windows  </td><td class="markdownTableBodyNone">User Certificate Store   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Linux  </td><td class="markdownTableBodyNone">~/.config/RobotRaconteur/certificates/   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Mac OS  </td><td class="markdownTableBodyNone">~/.config/RobotRaconteur/certificates/   </td></tr>
</table>
<p>Certificates are expected to be in PKCS #12 format with no password to be used by Robot Raconteur nodes. The file must have a .p12 extension. The file must contain the private key, the node certificate, and any intermediate certificates. For Linux and OSX, place the file in the directory specified in the table above. For Windows, certificates must be imported into the Windows user certificate store. Type "certmgr" in a command prompt, click "Import", and follow the instructions to import the file.</p>
<h1><a class="anchor" id="transport_security"></a>
Transport Security</h1>
<p>Robot Raconteur currently supports four transport types:</p>
<ul>
<li>LocalTransport - Provides communication between processes on the same computer</li>
<li>HardwareTransport - Provides communication with USB, Bluetooth, and PCIe devices</li>
<li>IntraTransport - Provides communication between nodes within the same process</li>
<li>TcpTransport - Provides communication between nodes over a network using TCP protocol</li>
</ul>
<p>Each transport has its own security concerns.</p>
<h2>LocalTransport</h2>
<p>By default, LocalTransport only allows incoming connections from the same user. The <code>public</code> flag when starting the LocalTransport server will allow any user within the <code>robotraconteur</code> group to connect. The <code>public</code> flag should only be used when the system does not have untrusted users logged in to the system. An example of an innapropriate place to use the LocalTransport <code>public</code> flag is on a shared supercomputer or mainframe system with many users logged in at the same time.</p>
<p>With the exception of the use of the <code>public</code> flag, the LocalTransport has no special security concerns and should be considered secure by default.</p>
<h2>HardwareTransport</h2>
<p>As with any type of hardware interface, only trusted devices should be connected to a computer using the USB, Bluetooth, or PCIe connections. These connections provide the hardware with a high degree of access to the system, and can easily compromise the security of the computer, regardless of the client and drivers in use. For this reason, there are no additional specific security concerns when using the Robot Raconteur HardwareTransport and the tranport can be considered secure by default.</p>
<h2>IntraTransport</h2>
<p>Since the IntraTransport never leaves the executing process, it can be considered secure by default.</p>
<h2>TcpTransport</h2>
<p>The TcpTransport has a number of security concerns that must be carefully managed. <b>Read this section carefully before deploying any Robot Raconteur devices on a network in a production environment.</b></p>
<p>The TcpTransport is capable of a number of operating modes, with varying levels of security. By default, the TcpTransport operates in <code>rr+tcp</code> mode, which is a raw unencrypted TCP connection. <code>rr+ws</code> is a slightly modified version that wraps the data in WebSocket messages to allow for communication with web browsers and web servers. These modes are suitable for research or hobbyist use, but <b>are not suitable for a production environment.</b> Internet of Things (IoT) devices are frequently targeted due to their lax security and access to valuable targets like factories, infrastructure, and personal data. The TcpTransport provides the ability to use Transport Layer Security (TLS) to protect communication between devices. TLS encrypts the communication between devices using advanced encryption algorithms, and is an international standard used for nearly all modern network communication.</p>
<p>For TLS to be activated, a certificate must be acquired installed for the server node as discussed in <a class="el" href="security.html#tls_certificates">TLS Certificates</a>. The client may also optionally have a certificate installed for client certificate authentication, but it is not requires for TLS communication. The certificate verifies the identity of the server, and prevents impersonation attacks that can cause the client to give up authentication credentials to a malicious device.</p>
<p>Once the TLS certificate has been installed, the client may use the following secure transport options:</p>
<ul>
<li><code>rrs+tcp</code> - Secure TLS/TCP connection</li>
<li><code>rrs+ws</code> - HTTP WebSocket connection <em>with message data encrypted using TLS</em></li>
<li><code>rr+wss</code> - HTTPS WebSocket connection <em>without message data encryption</em></li>
<li><code>rrs+wss</code> - HTTPS WebSocket connection <em>with message data encrypted</em></li>
</ul>
<p><code>rrs+tcp</code> should be used when communicating directly with a device without an HTTP elements involved, such as a Web Browser or Web Server. When a Web Browser or Web Server is involved, one of the three WebSocket options must be used: <code>rrs+ws</code>, <code>rr+wss</code>, or <code>rrs+wss</code>. The selection of which WebSocket option to use depends on the configuration of the system. The <code>rr+wss</code> and <code>rrs+wss</code> options depend on the use of HTTPS, which is the standard security method used for web pages and web services such as REST or SOAP. HTTPS depends a certificate issude by a major certificate authority that ties it to a domain name (DNS). These domain names are used to identify websites. For example <code>robotraconteur.com</code>, <code>wasontech.com</code>, <code>github.com</code>, etc are all domain names. Since IoT devices are not tied to DNS and do not have static IP addresses, this method of authentication is not available. The rule therefore is, use <code>rr+wss</code> or <code>rrs+wss</code> when an HTTPS certificate is available, such as when connecting to a web server running Robot Raconteur, and use <code>rrs+ws</code> when connecting to an IoT device that does not have HTTPS available.</p>
<p><code>rrs+ws</code> must be used carefully. The initial HTTP handshake is not encrypted. Encryption is only activated to protect the contents of messages once the connection has been established. This means that the entire connection URL and other metadata used during the handshake will be exposed. **Do not include any session keys as part of the Robot Raconteur URL query when using <code>rr+ws</code>.</p>
<p><code>rrs+wss</code> is "double encrypted" meaning at the entire connection is protected with HTTPS, and then the message data is again encrpted using TLS. This is only necessary when the identity of the client or server needs to be authenticated using Robot Raconteur certificates.</p>
<p><b>Using <a class="el" href="class_robot_raconteur_1_1_secure_server_node_setup.html" title="Initializes a RobotRaconteurNode instance to default configuration for a secure server and client nod...">RobotRaconteur::SecureServerNodeSetup</a> with enforce that clients connect with secure TcpTransport settings.</b></p>
<h2>Transport Security Summary</h2>
<p>The following rules of thumb should be followed to use Robot Raconteur transports securely:</p>
<ul>
<li>**Never use <code>rr+tcp</code> or <code>rr+ws</code> in a production environment</li>
<li>Use <a class="el" href="class_robot_raconteur_1_1_secure_server_node_setup.html" title="Initializes a RobotRaconteurNode instance to default configuration for a secure server and client nod...">RobotRaconteur::SecureServerNodeSetup</a> to enforce the use of secure transports</li>
<li>Do not include secrets should as tokens in URLs when using <code>rrs+ws</code></li>
<li>Use <code>rr+wss</code> or <code>rrs+wss</code> when HTTPS DNS certificates are available</li>
<li>Do not user LocalTransport <code>public</code> server option on shared systems</li>
<li>Never connect untrusted hardware to a USB, Bluetooth, or PCIe connection</li>
<li>Use certificates and certificate based authentication when possible </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
