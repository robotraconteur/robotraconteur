

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Service Discovery &mdash; Robot Raconteur Python  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Subscriptions" href="Subscriptions.html" />
    <link rel="prev" title="Webcam Example" href="WebcamPythonExample.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Robot Raconteur Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ServiceDefinition.html">Service Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="RobotRaconteurPython.html">Robot Raconteur Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="iRobotCreatePythonExample.html">iRobot Create Python Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebcamPythonExample.html">Webcam Example</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Service Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="Subscriptions.html">Subscriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObjectLocks.html">Exclusive object locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="TimeCritical.html">Time-critical software with Wire member</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForwardCompatibility.html">Forward compatibility with the “implements” statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="MemberModifiers.html">Member Modifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Async.html">Asynchronous programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="GatherScatter.html">Gather/Scatter operations</a></li>
</ul>
<p class="caption"><span class="caption-text">Framework:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/service_definition.html">Service Definitions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/nodes_and_communication.html">Robot Raconteur Nodes and Communication</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/locking.html">Object Locking</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/command_line_options.html">Node Setup Command Line Options</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/taps.html">Taps</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/robotraconteurgen.html">RobotRaconteurGen Utility</a></li>
</ul>
<p class="caption"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/Constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/RobotRaconteurNode.html">RobotRaconteurNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/DataTypes.html">Misc Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/PipeMember.html">Pipe Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/WireMember.html">Wire Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/CallbackMember.html">Callback Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Subscription.html">Subscription</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/NodeSetup.html">Node Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Transports.html">Transports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Timers.html">Timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Generators.html">Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Service.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ServiceSecurity.html">Service Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Logging.html">Logging and Taps</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Robot Raconteur Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Service Discovery</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/Discovery.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="service-discovery">
<span id="autodiscovery"></span><h1>Service Discovery<a class="headerlink" href="#service-discovery" title="Permalink to this headline">¶</a></h1>
<p>A powerful feature of Robot Raconteur is the ability to detect services automatically. Each transport has a method to
broadcast what services are available. For the <code class="docutils literal notranslate"><span class="pre">TcpChannel</span></code> this is accomplished through broadcast UDP packets. Other
transports will use the method most appropriate for the transport technology.</p>
<p>The first step in the auto-discovery process for TCP is for the node containing the service to broadcast an announcement
that the node is available. Version 0.9 and up use a request-response method for autodiscovery. Nodes send a broadcast
UDP packet every 55 seconds to announce that they are available and still listening. This low frequency broadcast is not
frequent enough for nodes searching for services, so broadcasting nodes will also wait for request broadcast packets.
Clients will send requests packets when they begin searching for services. Service nodes will then respond with their
connection information, after a random backoff period to prevent congestion. By default, the TCP discovery is only
enabled for IPv6 to reduce network traffic. IPv4 can be enabled by specifying different flags to the <code class="docutils literal notranslate"><span class="pre">TcpTransport</span></code> or
<code class="docutils literal notranslate"><span class="pre">ServerNodeSetup</span></code>.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">LocalTransport</span></code>, the discovery information is stored on the filesystem.</p>
<p>The packet sent by the service nodes contains the <code class="docutils literal notranslate"><span class="pre">NodeName</span></code>, <code class="docutils literal notranslate"><span class="pre">NodeID</span></code>, and a URL to connect to the “Service Index”,
which is a special service that lists the services registered in the node. The client will interrogate the service nodes
it has discovered to determine the available services. This is shown in the diagram by the client requesting the
available services, and the service node returns the available services. The “Service Index” is registered automatically
by the node and does not require any extra work by the user.</p>
<p>The auto-discovery functionality is automatically enabled by <code class="docutils literal notranslate"><span class="pre">ServerNodeSetup</span></code> and the
<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">RobotRaconteur.Client</span> <span class="pre">import</span> <span class="pre">*</span></code> functions. To manually enable auto-discovery on transports, use:</p>
<p><code class="docutils literal notranslate"><span class="pre">t=RR.TcpTransport()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">t.EnableNodeDiscoveryListening()</span></code></p>
<p>For the service, use:</p>
<p><code class="docutils literal notranslate"><span class="pre">t=RR.TcpTransport()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">t.EnableNodeAnnounce()</span></code></p>
<p>To find a service, use the command:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">res=RRN.FindServiceByType(&quot;experimental.create.Create&quot;,</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">[&quot;rr+local&quot;,&quot;rr+tcp&quot;,&quot;rrs+tcp&quot;])</span></code></div>
</div>
<p>where “experimental.create2.Create” is replaced with the fully qualified type being searched for and the second
parameter is a list of the transport types to search. <code class="docutils literal notranslate"><span class="pre">res</span></code> is a list of <code class="docutils literal notranslate"><span class="pre">ServiceInfo2</span></code> structures that contains the
<code class="docutils literal notranslate"><span class="pre">NodeID</span></code>, <code class="docutils literal notranslate"><span class="pre">NodeName</span></code>, <code class="docutils literal notranslate"><span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">RootObjectType</span></code>, <code class="docutils literal notranslate"><span class="pre">RootObjectImplements</span></code>, <code class="docutils literal notranslate"><span class="pre">ConnectionURL</span></code> (list), and the
<code class="docutils literal notranslate"><span class="pre">Attributes</span></code>. The attributes entry is type <code class="docutils literal notranslate"><span class="pre">varvalue{string}</span></code> but should only contain type <code class="docutils literal notranslate"><span class="pre">string</span></code> and numeric
entries. This is used to help identify the correct service to connect to. Service attributes are set through the
<code class="docutils literal notranslate"><span class="pre">ServerContext</span></code> object that is returned when a service is registered. A short example:</p>
<p><code class="docutils literal notranslate"><span class="pre">context=RRN.RegisterService</span> <span class="pre">(&quot;Create&quot;,&quot;experimental.create.Create&quot;,obj)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">attributes={&quot;RobotName&quot;</span> <span class="pre">:</span> <span class="pre">RR.RobotRaconteurVarValue(&quot;Create1&quot;,&quot;string&quot;)}</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">context.SetServiceAttributes(attributes)</span></code></p>
<p>Nodes can also be searched for by “NodeID” and “NodeName” separate from services. Use <code class="docutils literal notranslate"><span class="pre">FindNodeByID</span></code> and
<code class="docutils literal notranslate"><span class="pre">FindNodeByName</span></code> in <code class="docutils literal notranslate"><span class="pre">RobotRaconteurNode</span></code>. These will return the “NodeID”, “NodeName”, and the possible
“ConnectionURLs” without the query portion.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Subscriptions.html" class="btn btn-neutral float-right" title="Subscriptions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="WebcamPythonExample.html" class="btn btn-neutral float-left" title="Webcam Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Wason Technology, LLC

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>