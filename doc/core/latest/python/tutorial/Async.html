

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Asynchronous programming &mdash; Robot Raconteur Python  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gather/Scatter operations" href="GatherScatter.html" />
    <link rel="prev" title="Member Modifiers" href="MemberModifiers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Robot Raconteur Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ServiceDefinition.html">Service Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="RobotRaconteurPython.html">Robot Raconteur Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="iRobotCreatePythonExample.html">iRobot Create Python Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebcamPythonExample.html">Webcam Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discovery.html">Service Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="Subscriptions.html">Subscriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="ObjectLocks.html">Exclusive object locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="TimeCritical.html">Time-critical software with Wire member</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForwardCompatibility.html">Forward compatibility with the “implements” statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="MemberModifiers.html">Member Modifiers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Asynchronous programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="GatherScatter.html">Gather/Scatter operations</a></li>
</ul>
<p class="caption"><span class="caption-text">Framework:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/service_definition.html">Service Definitions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/nodes_and_communication.html">Robot Raconteur Nodes and Communication</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/locking.html">Object Locking</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/command_line_options.html">Node Setup Command Line Options</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/taps.html">Taps</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/robotraconteurgen.html">RobotRaconteurGen Utility</a></li>
</ul>
<p class="caption"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/Constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/RobotRaconteurNode.html">RobotRaconteurNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/DataTypes.html">Misc Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/PipeMember.html">Pipe Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/WireMember.html">Wire Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/CallbackMember.html">Callback Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Subscription.html">Subscription</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/NodeSetup.html">Node Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Transports.html">Transports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Timers.html">Timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Generators.html">Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Service.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ServiceSecurity.html">Service Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Logging.html">Logging and Taps</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Robot Raconteur Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Asynchronous programming</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/Async.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="asynchronous-programming">
<span id="asyncprog"></span><h1>Asynchronous programming<a class="headerlink" href="#asynchronous-programming" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">Most of the functions in Robot Raconteur are “blocking” functions, meaning that they will block the current executing
thread until the result of the operation is completed. An example is</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">RRN.ConnectService()</span></code>. This function will begin the connection process and block the current thread until the
connection is complete. This process can take anywhere from a few hundred milliseconds to several seconds. If the
client is only accessing one device this is normally not a problem, but if the client needs to connect to a hundred
devices this can become a severe problem as having a large number of threads becomes very computationally expensive
and difficult to coordinate. The solution to this problem is to use “asynchronous functions”. These functions begin
the operation but return immediately. When the operation is completed, a supplied handler function is called by the
thread pool.</div>
</div>
<p>Consider the synchronous connect function used in the previous examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="n">RRN</span><span class="o">.</span><span class="n">ConnectService</span><span class="p">(</span><span class="s1">&#39;rr+tcp://localhost:2354?service=Create&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The asynchronous equivalent would be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">connect_handler</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">err</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># If &quot;err&quot; is not None it means that an exception occurred.</span>
        <span class="c1"># &quot;err&quot; contains the exception object</span>
        <span class="nb">print</span> <span class="s2">&quot;An error occured! &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="nb">print</span> <span class="s2">&quot;Got the connection!&quot;</span>
    <span class="c1"># Now &quot;c&quot; is ready for use</span>

<span class="c1"># Start the connect process with a 5 second timeout</span>
<span class="n">c</span><span class="o">=</span><span class="n">RRN</span><span class="o">.</span><span class="n">AsyncConnectService</span><span class="p">(</span><span class="s1">&#39;rr+tcp://localhost:2354?service=Create&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">connect_handler</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># Do other tasks while connection is being created</span>
</pre></div>
</div>
<p>The form of “Async” functions is normally the same as synchronous functions but with “Async” prepended and two extra
parameters: the handler function and the timeout. The handler function will take zero, one, or two arguments depending
on the return arguments. The handler function can be any free module function or a bound instance method. The last
argument is the timeout, which is
in seconds. (Note: other language bindings use milliseconds for the timeout). The default for most is
RR_TIMEOUT_INFINITE which means the function will never timeout. This is not recommended as it can cause a deadlock.
Always specify a timeout.</p>
<p>For object references created by the <code class="docutils literal notranslate"><span class="pre">RRN.ConnectService()</span></code> function, functions, properties, and objrefs are available
in asynchronous form. In general these functions operate the same as their standard synchronous counterparts but are
prepended by <code class="docutils literal notranslate"><span class="pre">async_</span></code> and have two extra parameters, “handler” and “timeout”. The property forms use getter and setter
functions of the form <code class="docutils literal notranslate"><span class="pre">async_get_</span></code> and <code class="docutils literal notranslate"><span class="pre">async_set_</span></code>. If the function produces a return value, the handler will have
the form <code class="docutils literal notranslate"><span class="pre">handler(ret,</span> <span class="pre">err):</span></code>. For void functions, the handler will have the form <code class="docutils literal notranslate"><span class="pre">handler(err):</span></code>.</p>
<p>In Python 3, passing “None” for the handler will return a future that can be used with the “await” keyword.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="GatherScatter.html" class="btn btn-neutral float-right" title="Gather/Scatter operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="MemberModifiers.html" class="btn btn-neutral float-left" title="Member Modifiers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Wason Technology, LLC

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>