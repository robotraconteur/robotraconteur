

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exclusive object locks &mdash; Robot Raconteur Python  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time-critical software with Wire member" href="TimeCritical.html" />
    <link rel="prev" title="Authentication" href="Authentication.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Robot Raconteur Python
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ServiceDefinition.html">Service Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="RobotRaconteurPython.html">Robot Raconteur Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="iRobotCreatePythonExample.html">iRobot Create Python Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebcamPythonExample.html">Webcam Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Discovery.html">Service Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="Subscriptions.html">Subscriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Authentication.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exclusive object locks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#user">User</a></li>
<li class="toctree-l2"><a class="reference internal" href="#client">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monitor">Monitor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TimeCritical.html">Time-critical software with Wire member</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForwardCompatibility.html">Forward compatibility with the “implements” statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="MemberModifiers.html">Member Modifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Async.html">Asynchronous programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="GatherScatter.html">Gather/Scatter operations</a></li>
</ul>
<p class="caption"><span class="caption-text">Framework:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/service_definition.html">Service Definitions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/nodes_and_communication.html">Robot Raconteur Nodes and Communication</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/locking.html">Object Locking</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/command_line_options.html">Node Setup Command Line Options</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/taps.html">Taps</a></li>
<li class="toctree-l1"><a class="reference external" href="https://robotraconteur.github.io/robotraconteur/doc/core/latest/cpp/robotraconteurgen.html">RobotRaconteurGen Utility</a></li>
</ul>
<p class="caption"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/Constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/RobotRaconteurNode.html">RobotRaconteurNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/DataTypes.html">Misc Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/PipeMember.html">Pipe Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/WireMember.html">Wire Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/CallbackMember.html">Callback Member</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Subscription.html">Subscription</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/NodeSetup.html">Node Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Transports.html">Transports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Timers.html">Timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Generators.html">Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Service.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/ServiceSecurity.html">Service Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/Logging.html">Logging and Taps</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Robot Raconteur Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Exclusive object locks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/ObjectLocks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="exclusive-object-locks">
<span id="objectlocks"></span><h1>Exclusive object locks<a class="headerlink" href="#exclusive-object-locks" title="Permalink to this headline">¶</a></h1>
<p>During the first applications of the experimental version of Robot Raconteur there was a frequent problem of multiple
users trying to access a device remotely at the same time and causing confusing collisions. It became rapidly apparent
that some form of locking needed to be available. Robot Raconteur has three types of locks “User”, “Client”, and
“Monitor”.</p>
<div class="section" id="user">
<h2>User<a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h2>
<p>The “User” lock provides a lock on an object within a service that is exclusive to a specific username. The user must be
authenticated and have the “objectlock” privilege. The same user can authenticate multiple times from any location using
this lock. The lock works on the selected object, and all objects below the current object in the “objref” tree. (This
means all objects that are referenced by the locked object’s objrefs.) To lock an object, use:</p>
<p><code class="docutils literal notranslate"><span class="pre">RRN.RequestObjectLock(obj,</span> <span class="pre">RR.RobotRaconteurObjectLockFlags_USER_LOCK)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">obj</span></code> must be a Robot Raconteur client object reference. It does not have to be the root object. This function will
raise an exception if the object is already locked by another user. To release the lock, use:</p>
<p><code class="docutils literal notranslate"><span class="pre">RRN.ReleaseObjectLock(obj)</span></code></p>
<p>If the user has the privilege “objectlockoverride” the user can release all locks even if the user did not initiate the
lock.</p>
<p>Note that the lock will prevent transactional operations from occurring, but will not stop wire connections, pipe
endpoints, and events from functioning normally. If exclusive wire and pipe connections are required conflicting wire
and pipe connections will need to be closed by the service object.</p>
</div>
<div class="section" id="client">
<h2>Client<a class="headerlink" href="#client" title="Permalink to this headline">¶</a></h2>
<p>The “Client” lock is identical to the “User” lock but only allows one unique connection. This means that the user cannot
access the same service object from a different connection even with the same username. To request a client lock:</p>
<p><code class="docutils literal notranslate"><span class="pre">RRN.RequestObjectLock(obj,</span> <span class="pre">RR.RobotRaconteurObjectLockFlags\_CLIENT\_LOCK)</span></code></p>
<p>To release a client lock:</p>
<p><code class="docutils literal notranslate"><span class="pre">RRN.ReleaseObjectLock(obj)</span></code></p>
</div>
<div class="section" id="monitor">
<h2>Monitor<a class="headerlink" href="#monitor" title="Permalink to this headline">¶</a></h2>
<p>The “Monitor” lock provides a global thread monitor (more often called “mutex”) lock on a single object. This means that
globally only the current thread with the lock can access the object. The “Monitor” lock is intended for short
operations that cannot be interrupted and will timeout if 15 seconds elapses between operations on the client. It does
not inherit to other objects like “User” and “Client” locks. Unlike “User” and “Client”, the object must implement the
monitor locking functionality explicitly. (Note that the “RLock” type in Python does not support locking with timeout
which makes things a little less clear.) An example object that implements the required functionality:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>class MyMonitorLockableObject:

    def __init__(self):
        self._lock=threading.RLock()

    def RobotRaconteurMonitorEnter(self):
        self._lock.acquire()

    def RobotRaconteurMonitorEnter(self,timeout):
        self._lock.acquire()

    def RobotRaconteurMonitorExit(self):
        self._lock.release()``
</pre></div>
</div>
<p>To request a monitor lock on the client side, use:</p>
<p><code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">RR.RobotRaconteurNode.ScopedMonitorLock(obj):</span></code> <em>your code</em></p>
<p>The lock will be released when the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement block is exited.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="TimeCritical.html" class="btn btn-neutral float-right" title="Time-critical software with Wire member" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Authentication.html" class="btn btn-neutral float-left" title="Authentication" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Wason Technology, LLC

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>